<!doctype html>
<html lang="nl">

<head>
  <meta charset="utf-8" />
  <title>Vliegtuigen boven Arnhem</title>

  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem;
      line-height: 1.6;
      background: #fafafa;
      color: #222;
    }

    h1, h2 {
      border-bottom: 1px solid #ddd;
      padding-bottom: .2rem;
      margin-top: 2rem;
      font-weight: 500;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      background: white;
    }

    th, td {
      border: 1px solid #e3e3e3;
      padding: 0.5rem 0.6rem;
      font-size: 0.95rem;
    }

    th {
      background: #f0f0f0;
      font-weight: 600;
    }

    .note {
      font-size: 0.9rem;
      color: #666;
    }
  </style>
</head>

<body>

  <h1>Vliegtuigen boven Arnhem</h1>
  <p class="note">
    Gegevens afkomstig van <a href="https://adsb.fi" target="_blank">adsb.fi open data</a>.
    Dit project is persoonlijk & niet-commercieel.
  </p>

  <!-- ----------------------- LAST 10 UNIQUE ----------------------- -->

  <h2>Laatste 10 vliegtuigen (uniek per callsign)</h2>

  <table id="tbl-last10">
    <thead>
      <tr>
        <th>Tijd (Amsterdam)</th>
        <th>Callsign</th>
        <th>Snelheid (km/h)</th>
        <th>Hoogte (km)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const BACKEND = "https://arnhem-flights-api.onrender.com";

    function to_amsterdam(iso) {
      if (!iso) return "";
      const dt = new Date(iso);
      return dt.toLocaleString("nl-NL", {
        timeZone: "Europe/Amsterdam",
        hour12: false
      }).replace(",", "");
    }

    function kts_to_kmh(kts) {
      return kts ? (kts * 1.852).toFixed(1) : "";
    }

    function ft_to_km(ft) {
      return ft ? (ft * 0.0003048).toFixed(2) : "";
    }

    async function load_last10() {
      const r = await fetch(BACKEND + "/api/last10");
      const data = await r.json();

      const tbody = document.querySelector("#tbl-last10 tbody");
      tbody.innerHTML = "";

      data.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${to_amsterdam(row.ts)}</td>
          <td>${row.callsign}</td>
          <td>${kts_to_kmh(row.gs_kts)}</td>
          <td>${ft_to_km(row.alt_ft)}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // Initial load
    load_last10();

    // Refresh every minute
    setInterval(load_last10, 60000);
  </script>

</body>

</html>
